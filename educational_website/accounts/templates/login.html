{% extends "layout.html" %}

{% block title %}Login - Face Recognition{% endblock %}

{% load static %}

{% block style %}
<link rel="stylesheet" href="{% static 'login.css' %}">
{% endblock %}

{% block content %}
<body onclick="speak('Login Page')">
    <div class="login-container" onclick="event.stopPropagation()">
        <div id="camera-container">
            <div class="pattern-overlay" id="pattern-overlay"></div>
            <div class="scan-line"></div>
            <div class="scan-circle">
                <div class="scan-text">SCANNING</div>
            </div>
            <video id="video" width="380" height="380" autoplay></video>
            <canvas id="canvas" width="380" height="380"></canvas>
            <div class="scan-corner top-left"></div>
            <div class="scan-corner top-right"></div>
            <div class="scan-corner bottom-left"></div>
            <div class="scan-corner bottom-right"></div>
        </div>
        <div id="message">Please position your face in the center</div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Create the dotted pattern effect
            const patternOverlay = document.getElementById('pattern-overlay');
            
            // Function to create and animate dots
            function createDots() {
                // Clear existing dots first
                while (patternOverlay.firstChild) {
                    patternOverlay.removeChild(patternOverlay.firstChild);
                }
                
                // Create blue dots in a circular pattern around the full 360 degrees
                for (let i = 0; i < 800; i++) {
                    const angle = Math.random() * Math.PI * 2; // Full 360 degrees
                    const distance = 210 + Math.random() * 70; // Distance from center
                    
                    const x = Math.cos(angle) * distance + 250; // 250 is half of container width
                    const y = Math.sin(angle) * distance + 250; // 250 is half of container height
                    
                    // Create dots throughout the full circle
                    const distFromCenter = Math.sqrt(Math.pow(x - 250, 2) + Math.pow(y - 250, 2));
                    if (distFromCenter > 190 && distFromCenter < 260) {
                        const dot = document.createElement('div');
                        dot.className = 'dot breathing';
                        dot.style.width = Math.random() * 2 + 1 + 'px';
                        dot.style.height = dot.style.width;
                        dot.style.left = x + 'px';
                        dot.style.top = y + 'px';
                        dot.style.opacity = Math.random() * 0.5 + 0.2;
                        
                        // Calculate movement direction for breathing effect
                        // This ensures dots move radially outward from the center
                        const normalizedX = (x - 250) / distFromCenter;
                        const normalizedY = (y - 250) / distFromCenter;
                        
                        // Set custom properties for the dot's movement direction
                        dot.style.setProperty('--translate-x', normalizedX);
                        dot.style.setProperty('--translate-y', normalizedY);
                        
                        // Add animation with random delay for the pulsating effect
                        dot.style.animationDelay = `${Math.random() * 3}s`;
                        
                        patternOverlay.appendChild(dot);
                    }
                }
            }
            
            // Initial dot creation
            createDots();
            
            // Regenerate dots periodically to maintain fresh effect
            setInterval(createDots, 10000);
            
            // Add secondary pulsing circles
            for (let i = 0; i < 3; i++) {
                const pulseCircle = document.createElement('div');
                pulseCircle.style.position = 'absolute';
                pulseCircle.style.width = '460px';
                pulseCircle.style.height = '460px';
                pulseCircle.style.borderRadius = '50%';
                pulseCircle.style.border = `1px solid rgba(0, 102, 255, ${0.3 - i * 0.1})`;
                pulseCircle.style.animation = `pulse ${4 + i}s infinite ${i * 0.8}s`;
                pulseCircle.style.zIndex = '1';
                
                document.getElementById('camera-container').appendChild(pulseCircle);
            }
            
        });
    </script>
    
</body>
{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="{% static 'login.js' %}"></script>
<script src="{% static 'voice-navigation.js' %}"></script>
<script src="{% static 'voice-feedback.js' %}"></script>

{% endblock %}